version: "3"
services:
  steam_backend:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - <port_on_host>:8000 # TODO: change to your port on host
    restart: always
    environment:
      - DATABASE_ENGINE=mysql
      - DATABASE_NAME=steam
      - DATABASE_USER=root
      - DATABASE_PASSWORD=steam
      - DATABASE_HOST=steam_mysql
      - DATABASE_PORT=3306
      - REDIS_HOST=steam_redis
      - REDIS_PORT=6379
      - REDIS_USERNAME=
      - REDIS_PASSWORD=
      - EMAIL_HOST=smtp.gmail.com
      - EMAIL_PORT=587
      - EMAIL_HOST_USER=steam@bdu.edu.vn
      - EMAIL_HOST_PASSWORD= # TODO: change to your email host password
      - BETTERSTACK_LOG_TOKEN=dXECcUYZxNVLX5GHN8XyRhzt
      - BETTERSTACK_LOG_HOST=s1529184.eu-nbg-2.betterstackdata.com
      - GDRIVE_SERVICE_ACCOUNT_FILE=/usr/src/app/service_account.json
      - GDRIVE_DEFAULT_FOLDER_ID=1VHUbV2LkYQdUDNlN2unNbxLYwT-PEV1H
    volumes:
      - <path_on_host>/service_account.json:/usr/src/app/service_account.json # TODO: change to your service account file path
    depends_on:
      - steam_mysql
      - steam_redis

  steam_mysql:
    image: mysql:8.0
    restart: always
    environment:
      MYSQL_DATABASE: "steam"
      MYSQL_ROOT_PASSWORD: "steam"
    ports:
      - <port_on_host>:3306 # TODO: change to your port on host
    volumes:
      - mysql_data:/var/lib/mysql # TODO: change to your mysql data path

  steam_redis:
    image: redis:6.0
    restart: always
    ports:
      - <port_on_host>:6379 # TODO: change to your port on host
    volumes:
      - redis_data:/data # TODO: change to your redis data path

volumes:
  mysql_data:
  redis_data:
